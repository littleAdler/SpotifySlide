<!doctype html>
<html>
  <head>
    <script src="https://apis.google.com/js/api.js"></script>
    <script src="//cdnjs.cloudflare.com/ajax/libs/handlebars.js/4.0.0/handlebars.min.js"></script>
    <script src="http://code.jquery.com/jquery-3.3.1.min.js"></script>
    <script src="https://ajax.googleapis.com/ajax/libs/jqueryui/1.12.1/jquery-ui.min.js"></script>

    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <link rel="stylesheet" href="style_side.css">

    <title>SpotifySlide</title>
    <link rel="icon" href="https://encrypted-tbn0.gstatic.com/images?q=tbn:ANd9GcTyI-X6qZTO1bDt5K8PWTOM__9xtvuDjeJ0rKJRWTjzFxQgGJ-I">

    <link rel="stylesheet" href="//netdna.bootstrapcdn.com/bootstrap/4.0.0/css/bootstrap.min.css">
    <link rel="stylesheet" type="text/css" href="style.css">
    <link rel="stylesheet" type="text/css" href="sideExpansion.css">

    <style type="text/css">
      #login, #loggedin {
        display: none;
      }

      .text-overflow {
        overflow: hidden;
        text-overflow: ellipsis;
        white-space: nowrap;
        width: 500px;
      }
    </style>
  </head>

  <body>
    <div class="container">
      <div id="login">

        <h1 id="login-welcome">Welcome To Slide!</h1>
        <p id="login-message">Start by logging in with your spotify acount</p>
        <a href="/login" id="spotloginbut" class="btn btn-outline-success disabled" role="button" aria-disabled="true">Log in with Spotify</a>
        <button class="btn btn-outline-warning" onclick="authenticate().then(loadClient)">authorize slides</button>

        <!-- Test slides API call-->
        <button class="btn btn-outline-success" onclick="execute()">Run</button>

      </div>
      <!-- Display the website after the proper auth procedure-->
      <div id="loggedin">

            <div class="wrapper">
                <!-- Sidebar Holder -->
                <div id="content">

                  <iframe src="" id="slideFrame" frameborder="0" width="1366" height="768" allowfullscreen="true" mozallowfullscreen="true" webkitallowfullscreen="true"></iframe>

                </div>
                <nav id="sideExpansion">

                  <br>
                  Google Slides Project ID:<br>
                  <input class="input-group-text" type="text" id="gslidesId" name="slidesProjectId"><br>
                  Iframe:<br>
                  <input class="input-group-text" type="text" id="gslidesIFrame" name="slidesIframe"><br>


                  <br>

                  <div id="currentSelectionBox">



                  <form id="expansionForm">


              <!-- Slot Template Reference

                    <div class="slot1">
                    <div class="input-group mb-3">

                    <div class="input-group-prepend">
                    <label class="input-group-text" for="inputGroupSelect01">Options</label>
                  </div>

                  <select class="custom-select" id="playlist1">
                  <option selected>Choose...</option>
                  <option>Disco Waltz</option>
                  <option>Latin Hustle</option>
                  <option>Fox Trot</option>
                </select>
              -->

                  <button id="dropDownbtn" class="btn btn-outline-info" onclick="addSelect('expansionForm')">Add Dropdown</button>
                  </form>
                  </div>

                  <br>
                  <br>
                  <br>
                  <button id="slideAuth" class="btn btn-outline-warning" onclick="authenticate().then(loadClient)">authorize slides</button>

                  <!--<button id="regenerateSlideOrder" onclick="generateSlideOrder()">Generate Slide Order</button> -->
                  <div id="slideOrder">
                  </div>
                  <!-- <button class="btn btn-outline-info" onclick="addSelect('expansionForm')">Add Dropdown</button> -->
                  <button id="runBtn" class="btn btn-outline-success" onclick="setInterval(execute,5000)">Run</button>
                </nav>


                <nav id="sidebar">
                    <div class="sidebar-header">
                        <!-- <h3>Logo</h3> -->
                        <img id="logo" src="logo/Logo_v1_00000.jpg"></img>


                      <!--  <button onclick="updateSlidePosition()">slideUpdate</button> -->
                    </div>

                    <ul id = "comps" class="list-unstyled components">

                        <div id="user-profile">
                        </div>

                        <div id='playback'>
                        </div>

                        <div id="oauth">
                        </div>

                    </ul>
                </nav>

                <!-- Page Content Holder -->


                <script>
                  /**
                   * Sample JavaScript code for slides.presentations.get
                   * See instructions for running APIs Explorer code samples locally:
                   * https://developers.google.com/explorer-help/guides/code_samples#javascript
                   */




                  function authenticate() {
                    return gapi.auth2.getAuthInstance()
                        .signIn({scope: "https://www.googleapis.com/auth/drive https://www.googleapis.com/auth/drive.file https://www.googleapis.com/auth/drive.readonly https://www.googleapis.com/auth/presentations https://www.googleapis.com/auth/presentations.readonly"})
                        .then(function() {
                          console.log("Sign-in successful");
                          document.getElementById("spotloginbut").classList.remove('disabled');
                          $("#slideAuth").hide();
                          document.getElementById("slideFrame").src=document.getElementById("gslidesIFrame").value;

                          //Generate Slide Order




                        },
                              function(err) { console.error("Error signing in", err); });
                  }
                  function loadClient() {
                    return gapi.client.load("https://content.googleapis.com/discovery/v1/apis/slides/v1/rest")
                        .then(function() { console.log("GAPI client loaded for API"); },
                              function(err) { console.error("Error loading GAPI client for API", err); });
                  }
                  // Make sure the client is loaded and sign-in is complete before calling this method.
                  slideHold='';
                    function execute() {
                      //console.log("Slide:"+ document.getElementById("slide1").value);
                      //console.log(gapi.client);
                      //console.log(document.getElementById("gslidesId").value);
                      return gapi.client.slides.presentations.get({
                        "presentationId": document.getElementById("gslidesId").value
                      })
                          .then(function(response) {
                                  // Handle the results here (response.result has the parsed body).
                                  //console.log("Response", response);

                                  //console.log(response);
                                  if(slideHold!==JSON.parse(response.body).slides[0].objectId){
                                    document.getElementById('slideFrame').src = document.getElementById('slideFrame').src+'';
                                    console.log("refresh");
                                    slideHold=JSON.parse(response.body).slides[0].objectId;
                                  }


                                },
                                function(err) { console.error("Execute error", err);
                              });
                    }

                    let r=0;
                    function addSelect(divname) {
                      r++;
                      //Call for google slide ids
                      return gapi.client.slides.presentations.get({
                        "presentationId": document.getElementById("gslidesId").value
                      })
                      .then(function(response) {

                        var newDiv=document.createElement('select');
                        var outerDiv1=document.createElement('div');
                        var outerDiv2=document.createElement('div');

                        //outerDiv1.innerHTML =".slot"+r+" {  position: relative; padding-left: -10px; padding-top: 30px;}";
                        var style = document.createElement('style');
                        style.type = 'text/css';
                        style.innerHTML = ".slot"+r+" {  position: relative; padding-left: -10px; padding-top: 4px;}";
                        outerDiv1.appendChild(style);
                        outerDiv1.setAttribute("class","slot"+r);
                        outerDiv2.setAttribute("class","input-group mb-3");

                        newDiv.setAttribute("id","slideSlot"+r);
                        newDiv.setAttribute("class","custom-select");
                        var html = '', i;

                        for(i = 0; i < JSON.parse(response.body).slides.length; i++) {
                          html += "<option value='"+JSON.parse(response.body).slides[i].objectId+"'>"+JSON.parse(response.body).slides[i].objectId+"</option>";
                        }
                        //html += '</select>';

                        newDiv.innerHTML= html;
                        outerDiv2.innerHTML=newDiv.outerHTML;
                        //outerDiv1.innerHTML=outerDiv2.outerHTML;

                        //document.getElementById(divname).appendChild(outerDiv1);



                        //Token Params
                        function getHashParams() {
                          var hashParams = {};
                          var e, r = /([^&;=]+)=?([^&;]*)/g,
                              q = window.location.hash.substring(1);
                          while ( e = r.exec(q)) {
                             hashParams[e[1]] = decodeURIComponent(e[2]);
                          }
                          return hashParams;
                        }
                        var params = getHashParams();

                        var access_token = params.access_token,
                            refresh_token = params.refresh_token,
                            error = params.error;

                        //Call for spotify playlist names
                        $.ajax({
                          url: 'https://api.spotify.com/v1/me/playlists',
                          headers:{
                            'Authorization':'Bearer '+ access_token
                          },
                          success: function(response){
                            let playlistArr=[];
                            let totalTracks=[];

                            var newDiv2 = document.createElement('select');
                            newDiv2.setAttribute("id","playlistSlot"+r);
                            newDiv2.setAttribute("class","custom-select");

                            var html2='', i;

                            for(i = 0; i < response.items.length; i++) {
                              html2 += "<option value='"+response.items[i].name+"'>"+response.items[i].name+"</option>";
                            }
                            newDiv2.innerHTML=html2;
                            outerDiv2.innerHTML+=newDiv2.outerHTML;
                            outerDiv1.innerHTML+=outerDiv2.outerHTML;

                            document.getElementById(divname).appendChild(outerDiv1);
                            //console.log(response.items[0].name)


                            //console.log(globalSongName);
                            //playlistArr[i]=response.items[i].name;
                            //totalTracks[i]=response.items[i].tracks.total;


                          }
                        });

                      });
                    }

                  gapi.load("client:auth2", function() {
                    gapi.auth2.init({client_id: "218122630000-fquo9nr0b7ldh0d0dvb23k2hkiaq6rh1.apps.googleusercontent.com"});
                  });

                  function classSwap(holdClass){
                    $('.currentPlaySlot').switchClass("currentPlaySlot",`${holdClass}`,1000);


                  }

                  let holdClass="";

                  function updateSlidePosition(spotifyPlaylist){
                    console.log("update");
                    //console.log("Slide: "+document.getElementById("slide1").value);
                    //console.log("Playlist: "+document.getElementById("playlist1").value);
                    let slideID ='';
                    //let spotifyPlaylist = 'Disco Waltz';
                    //let sliden=slideName
                    //let spotifyPlaylist="Update Test"
                    //console.log(testSlide);
                    //let testSlide='';
                    //console.log("Playlist Selected: "+document.getElementById("playlistSlot1").value);

                    for(let k=1; k<=r; k++){
                      console.log("Playlist: "+document.getElementById(`playlistSlot${k}`).value)
                      if(document.getElementById(`playlistSlot${k}`).value!==null && spotifyPlaylist=== document.getElementById(`playlistSlot${k}`).value){
                          //slideID = document.getElementById("slide1").value;
                          slideID =document.getElementById(`slideSlot${k}`).value;
                          console.log("Slide ID: "+document.getElementById(`slideSlot${k}`).value);

                          if(holdClass!==`slot${k}`){
                            $(`.slot${k}`).switchClass(`slot${k}`,"currentPlaySlot",1000);
                            classSwap(holdClass);
                          }
                          holdClass=`slot${k}`;
                      }
                    }

                    /*
                    if(spotifyPlaylist==='Update Test'){
                        slideID = 'p';

                    }else if(spotifyPlaylist=== document.getElementById("playlistSlot1").value){
                        //slideID = document.getElementById("slide1").value;
                        slideID =document.getElementById("slideSlot1").value;
                        console.log("Slide ID: "+document.getElementById("slideSlot1").value);
                        $('.slot1').switchClass("slot1","currentPlaySlot",1000);
                        if(holdClass!=="slot1"){
                          classSwap(holdClass);
                        }
                        holdClass="slot1";
                        //.then(classSwap([2,3,4,5,6,7,8]));

                        //$('.slot1').removeClass("firstSlot").addClass("currentPlaySlot");
                    }else if(spotifyPlaylist ===document.getElementById("playlistSlot2").value){
                        slideID = document.getElementById("slideSlot2").value;
                        if(holdClass!=="slot2"){
                        $('.slot2').switchClass("slot2","currentPlaySlot",1000);
                        classSwap(holdClass);
                        }
                        holdClass="slot2";


                    }else if (spotifyPlaylist === document.getElementById("playlist3").value){
                        slideID = document.getElementById("slide3").value;
                        if(holdClass!=="thirdSlot"){
                        $('.thirdSlot').switchClass("thirdSlot","currentPlaySlot",1000);
                        classSwap(holdClass);
                        }
                        holdClass="thirdSlot";

                    }else if (spotifyPlaylist === document.getElementById("playlist4").value){
                        slideID = document.getElementById("slide4").value;
                        if(holdClass!=="fourthSlot"){
                        $('.fourthSlot').switchClass("fourthSlot","currentPlaySlot",1000);
                        classSwap(holdClass);
                        }
                        holdClass="fourthSlot";

                    }else if (spotifyPlaylist === document.getElementById("playlist5").value){
                        slideID = document.getElementById("slide5").value;
                        if(holdClass!=="fifthSlot"){
                        $('.fifthSlot').switchClass("fifthSlot","currentPlaySlot",1000);
                        classSwap(holdClass);
                        }
                        holdClass="fifthSlot";

                    }else if (spotifyPlaylist === document.getElementById("playlist6").value){
                        slideID = document.getElementById("slide6").value;
                        if(holdClass!=="sixthSlot"){
                        $('.sixthSlot').switchClass("sixthSlot","currentPlaySlot",1000);
                        classSwap(holdClass);
                        }
                        holdClass="fourthSlot";

                    }else if (spotifyPlaylist === document.getElementById("playlist7").value){
                        slideID = document.getElementById("slide7").value;
                        if(holdClass!=="seventhSlot"){
                        $('.seventhSlot').switchClass("seventhSlot","currentPlaySlot",1000);
                        classSwap(holdClass);
                        }
                        holdClass="seventhSlot";

                    }else if (spotifyPlaylist === document.getElementById("playlist8").value){
                        slideID = document.getElementById("slide8").value;
                        if(holdClass!=="eighthSlot"){
                        $('.eighthSlot').switchClass("eighthSlot","currentPlaySlot",1000);
                        classSwap(holdClass);
                        }
                        holdClass="eighthSlot";
                    }
                    */

                    return gapi.client.slides.presentations.batchUpdate({
                      presentationId: '1F7t4uUsk8Hk8RzyHVp-2uoeiXZg-evsFttWHJqBnSDY',
                      "access_token": 'ya29.Glu6BQgGG4k0CNyFP-LmuUQzXXxkbc5KQrIaUXQsmzWtlZ5mZqosm3zUe2PVHH-RgLoZS3yAPLUad1KN394EPjuIYZM4iCLB2qMAC7xvAI3ZFoztVwY3gsr7ziOX',
                      "resource": {
                          "requests": [
                              {
                                  "updateSlidesPosition": {
                                      "slideObjectIds": [
                                          slideID
                                      ],
                                      "insertionIndex": 0
                                  }
                              }
                          ]
                      }
                    })
                    .then(function(response){
                      //console.log(response);
                    });
                  }

                </script>

            </div>

        <!--
        <button class="btn btn-default" id="obtain-new-token">Obtain new token using the refresh token</button>
        -->

      </div>
    </div>


    <script id="user-profile-template" type="text/x-handlebars-template">
      <p>Current Profile:</p>
      <p><img id="profilePic" class="media-object" width="50" src="{{images.0.url}}" /> {{display_name}}</p>
      <div class="media">



        <div class="media-body">
          <dl class="dl-horizontal">
            <!--
            <dt>Display name</dt><dd class="clearfix">{{display_name}}</dd>
            <dt>Id</dt><dd>{{id}}</dd>
            <dt>Email</dt><dd>{{email}}</dd>
            <dt>Spotify URI</dt><dd><a href="{{external_urls.spotify}}">{{external_urls.spotify}}</a></dd>
            <dt>Link</dt><dd><a href="{{href}}">{{href}}</a></dd>
            <dt>Profile Image</dt><dd class="clearfix"><a href="{{images.0.url}}">{{images.0.url}}</a></dd>
            <dt>Country</dt><dd>{{country}}</dd>
          -->
          </dl>
        </div>
      </div>
    </script>

    <script id="playback-template" type="text/x-handlebars-template">
      <h2 id="playbackTitle">Playback Info </h2>
      <img id="albumArt" class="media-object" width="150" src="{{item.album.images.0.url}}"/>
      <dl id ="playbackInfo" class="dl-horizontal">
        <dt >Currently Playing</dt><dd>{{item.name}}</dd>
        <dt >Duration</dt><dd>{{item.duration_ms}}</dd>
        <!-- <dt>Album Art</dt><dd><a href="{{item.album.images.0.url}}">{{item.album.images.0.url}}</a></dd>-->
      </dl>
    </script>


    <script id="slide-order-template" type="text/x-handlebars-template">
      <!--
      <h2 id="orderTitle">Slide Order</h2>
      <dl>
        <dd>
             1. {{result.slides.0.pageElements.0.shape.text.textElements.1.textRun.content}}
                ({{result.slides.0.objectId}})
             2. {{result.slides.1.pageElements.0.shape.text.textElements.1.textRun.content}}
                ({{result.slides.1.objectId}})
             3. {{result.slides.2.pageElements.0.shape.text.textElements.1.textRun.content}}
                ({{result.slides.2.objectId}})
             4. {{result.slides.3.pageElements.0.shape.text.textElements.1.textRun.content}}
                ({{result.slides.3.objectId}})
             5. {{result.slides.4.pageElements.0.shape.text.textElements.1.textRun.content}}
                ({{result.slides.4.objectId}})
             6. {{result.slides.5.pageElements.0.shape.text.textElements.1.textRun.content}}
                ({{result.slides.5.objectId}})
             7. {{result.slides.6.pageElements.0.shape.text.textElements.1.textRun.content}}
                ({{result.slides.6.objectId}})
             8. {{result.slides.7.pageElements.0.shape.text.textElements.1.textRun.content}}
                ({{result.slides.7.objectId}})
             9. {{result.slides.8.pageElements.0.shape.text.textElements.1.textRun.content}}
                ({{result.slides.8.objectId}})
        </dd>
      </dl>
    -->
    </script>



    <script id="oauth-template" type="text/x-handlebars-template">
      <!--
      <h3>oAuth info</h3>
    -->
      <dl class="dl-horizontal">
        <!--
        <dt>Access token</dt><dd class="text-overflow">{{access_token}}</dd>
        <dt>Refresh token</dt><dd class="text-overflow">{{refresh_token}}</dd>
      -->
      </dl>
    </script>
<!--
    <script src="//cdnjs.cloudflare.com/ajax/libs/handlebars.js/4.0.0/handlebars.min.js"></script>
    <script src="http://code.jquery.com/jquery-3.3.1.min.js"></script>
-->
    <script>
      (function() {
        function generateSlideOrder(){
          return gapi.client.slides.presentations.get({
            "presentationId": document.getElementById("gslidesId").value
          })
           .then(function(response){
              //console.log(response);
               slideOrderPlaceholder.innerHTML = slideOrderTemplate(response);
           });
        }
        setInterval(generateSlideOrder,10000);
          let globalSongName='';
        /**
         * Obtains parameters from the hash of the URL
         * @return Object
         */
        function getHashParams() {
          var hashParams = {};
          var e, r = /([^&;=]+)=?([^&;]*)/g,
              q = window.location.hash.substring(1);
          while ( e = r.exec(q)) {
             hashParams[e[1]] = decodeURIComponent(e[2]);
          }
          return hashParams;
        }

        var slideOrderSource =document.getElementById("slide-order-template").innerHTML,
            slideOrderTemplate = Handlebars.compile(slideOrderSource),
            slideOrderPlaceholder = document.getElementById('slideOrder');


        var userProfileSource = document.getElementById('user-profile-template').innerHTML,
            userProfileTemplate = Handlebars.compile(userProfileSource),
            userProfilePlaceholder = document.getElementById('user-profile');

        var playbackSource = document.getElementById('playback-template').innerHTML,
            playbackTemplate = Handlebars.compile(playbackSource),
            playbackPlaceholder = document.getElementById('playback');


        var oauthSource = document.getElementById('oauth-template').innerHTML,
            oauthTemplate = Handlebars.compile(oauthSource),
            oauthPlaceholder = document.getElementById('oauth');

        var params = getHashParams();

        var access_token = params.access_token,
            refresh_token = params.refresh_token,
            error = params.error;

        if (error) {
          alert('There was an error during the authentication');
        } else {
          if (access_token) {
            // render oauth info
            oauthPlaceholder.innerHTML = oauthTemplate({
              access_token: access_token,
              refresh_token: refresh_token
            });

            $.ajax({
                url: 'https://api.spotify.com/v1/me',
                headers: {
                  'Authorization': 'Bearer ' + access_token
                },
                success: function(response) {
                  userProfilePlaceholder.innerHTML = userProfileTemplate(response);

                  $('#login').hide();
                  $('#loggedin').show();
                }
            });




            setInterval(currentSongName,3000);
            //ajax call to get the current playback (returns the currently playing song name)
            let holdSongName='';
            function currentSongName(){
              //console.log("Run currentSongName()");

            $.ajax({
                url: 'https://api.spotify.com/v1/me/player/currently-playing',
                headers: {
                  'Authorization': 'Bearer ' + access_token
                },
                success: function(response){
                  //console.log(response);
                  //Convert time into minutes and seconds
                  decimalMinutes= response.item.duration_ms/(60*1000) - Math.floor(response.item.duration_ms/(60*1000));
                  seconds = Math.floor(decimalMinutes*60);
                  minutes = Math.floor(response.item.duration_ms/(60*1000));


                  //handles the time display formating (ex. 3:05 vs 3:5 AND 3:12 vs 3:012)
                  if(seconds<10){
                    response.item.duration_ms=`${minutes}:0${seconds}`
                  }else{
                    response.item.duration_ms=`${minutes}:${seconds}`
                  }

                  //load the object into the handlbars template
                  playbackPlaceholder.innerHTML = playbackTemplate(response);
                  let song_name=response.item.name;



                $.ajax({
                  url: 'https://api.spotify.com/v1/me/playlists',
                  headers:{
                    'Authorization':'Bearer '+ access_token
                  },
                  success: function(response){
                    let playlistArr=[];
                    let totalTracks=[];
                    //console.log(response.items[0].name)
                    let stop=false;
                    for(let i=0 ; i<8 ; i++){
                      //console.log(globalSongName);
                    playlistArr[i]=response.items[i].name;
                    totalTracks[i]=response.items[i].tracks.total;


                        $.ajax({
                          url: response.items[i].tracks.href,
                          headers:{
                            'Authorization':'Bearer '+ access_token
                          },
                          success: function(response){
                            //console.log("Last Track:"+response.items[totalTracks].track.name)
                            for(let j=0; j<totalTracks[i];j++){
                            if(response.items[j].track.name === song_name && holdSongName!==song_name){
                              console.log("Current Playlist: "+playlistArr[i]);
                              holdSongName=song_name;
                              updateSlidePosition(playlistArr[i]);

                            }
                          }

                       }
                        });

                   }

                   //console.log(playlistArr);
                }
                });

                }
            });

            return globalSongName;
            }










          } else {
              // render initial screen
              $('#login').show();
              $('#loggedin').hide();
          }
/*
          document.getElementById('obtain-new-token').addEventListener('click', function() {
            $.ajax({
              url: '/refresh_token',
              data: {
                'refresh_token': refresh_token
              }
            }).done(function(data) {
              access_token = data.access_token;
              oauthPlaceholder.innerHTML = oauthTemplate({
                access_token: access_token,
                refresh_token: refresh_token
              });
            });
          }, false);
          */
        }
      })();

    </script>

    <script>
      $("#sideExpansion").hover(
        function(){
        $("#sideExpansion").stop(true,false);
        $("#sideExpansion").animate({
          left: "0px"
        },1000);


      }, function(){
        $("#sideExpansion").stop(true,false);
        $("#sideExpansion").animate({
          left: "-500px"
        },1000)

      });




    </script>

<!--
    <script id="SlidesAPI">

    function refresh_iFrame(){
      //document.getElementById('slideFrame').src = document.getElementById('slideFrame').src+''

    //swap_iFrame;
    console.log($('#slideFrame').css('z-index'));
    console.log($('#slideFrame2').css('z-index'));
    //console.log($('#slideFrame').css('z-index')==1);
    if($('#slideFrame').css('z-index')==1 ){
      console.log('inside if');
      document.getElementById('slideFrame2').src = document.getElementById('slideFrame2').src+'';
      focus_slideFrame2();


    }else if($('#slideFrame2').css('z-index')==1){
      console.log("inside else");
      document.getElementById('slideFrame').src = document.getElementById('slideFrame').src+'';
      focus_slideFrame();




    }

    }

    function focus_slideFrame() {
      document.getElementById('slideFrame').style.zIndex = 1;
      document.getElementById('slideFrame2').style.zIndex = -1;

    }
    function focus_slideFrame2() {
      document.getElementById('slideFrame').style.zIndex = -1;
      document.getElementById('slideFrame2').style.zIndex = 1;

    }

    function swap_iFrame(){
      $('#slideFrame').css('z-index',2);
      $('#slideFrame2').css('z-index',1);
    /*  $('#slideFrame').toggleClass('active');
      $('#slideFrame2').toggleClass('active');
      */
    }
    function swap_iFrame2(){
      $('#slideFrame').css('z-index',1);
      $('#slideFrame2').css('z-index',2);

    }

    $(document).ready(function(){
      //$('#slideFrame').css("display","block");
      //setInterval(refresh_iFrame,6000);

    });
    </script>
  -->

  </body>
</html>
